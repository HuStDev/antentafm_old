
<VirtualHost *:80>
        ServerAdmin hust@earth
        ServerName antentafm.ddnss.de

        <Location />
                Require all granted
        </Location>

        RewriteEngine On
        RewriteCond %{SERVER_NAME} =radio.antentafm.ddnss.de
        RewriteRule ^ https://%{SERVER_NAME}%{REQUEST_URI} [END,NE,R=permanent]
</VirtualHost>

<IfModule mod_ssl.c>
<VirtualHost *:443>
        ServerAdmin hust@earth
        ServerName antentafm.ddnss.de

        LogLevel info
        ErrorLog /var/log/radio.antentafm.ddnss.de.error.log
        TransferLog /var/log/radio.antentafm.ddnss.de.access.log

        SSLEngine On
        Include /etc/letsencrypt/options-ssl-apache.conf
        SSLCertificateFile /etc/letsencrypt/live/antentafm.ddnss.de/fullchain.pem
        SSLCertificateKeyFile /etc/letsencrypt/live/antentafm.ddnss.de/privkey.pem

        <Location />
                Require all granted
        </Location>

        RewriteEngine On
        RewriteCond %{HTTP:Upgrade} =websocket [NC]
        RewriteRule /(.*) ws://localhost:3030/$1 [P,L]
        RewriteCond %{HTTP:Upgrade} !=websocket [NC]
        RewriteRule /(.*) http://localhost:3030/$1 [P,L]

        RewriteCond %{HTTP:Authorization} ^(.*)
        RewriteRule .* - [e=HTTP_AUTHORIZATION:%1]

        ProxyPassReverse / http://localhost:3030/
</VirtualHost>
</IfModule>

