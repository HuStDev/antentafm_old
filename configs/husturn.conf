<VirtualHost *:80>
        ServerAdmin hust@earth
        ServerName turn.worktenta.ddnss.de

        LogLevel info
        ErrorLog /var/log/turn.worktenta.com_error.log
        TransferLog /var/log/turn.worktenta.com_access.log

        <Location />
                Require all granted
        </Location>

        RewriteEngine On
        RewriteCond %{HTTP:Upgrade} =websocket [NC]
        RewriteRule /(.*)           ws://localhost:3478/$1 [P,L]
        RewriteCond %{HTTP:Upgrade} !=websocket [NC]
        RewriteRule /(.*)           http://localhost:3478/$1 [P,L]

        RewriteCond %{HTTP:Authorization} ^(.*)
        RewriteRule .* - [e=HTTP_AUTHORIZATION:%1]

        ProxyPassReverse /          http://localhost:3478/
</VirtualHost>

<IfModule mod_ssl.c>
<VirtualHost *:443>
	ServerAdmin hust@earth
	ServerName turn.worktenta.ddnss.de

	LogLevel info
	ErrorLog /var/log/turn.worktenta.com_error.log
	TransferLog /var/log/turn.worktenta.com_access.log

	SSLEngine On	
	SSLCertificateFile /etc/letsencrypt/live/turn.worktenta.ddnss.de/fullchain.pem
	SSLCertificateKeyFile /etc/letsencrypt/live/turn.worktenta.ddnss.de/privkey.pem
	SSLCertificateChainFile /etc/letsencrypt/live/turn.worktenta.ddnss.de/chain.pem

	<Location />
		Require all granted
	</Location>

	RewriteEngine On
	RewriteCond %{HTTP:Upgrade} =websocket [NC]
	RewriteRule /(.*)           ws://localhost:5349/$1 [P,L]
	RewriteCond %{HTTP:Upgrade} !=websocket [NC]
	RewriteRule /(.*)           http://localhost:5349/$1 [P,L]

	RewriteCond %{HTTP:Authorization} ^(.*)
	RewriteRule .* - [e=HTTP_AUTHORIZATION:%1]

	ProxyPassReverse /          http://localhost:5349/
</VirtualHost>
</IfModule>
