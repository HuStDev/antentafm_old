<VirtualHost *:80>
        ServerAdmin hust@earth
        ServerName stream.antentafm.ddnss.de

        <Location />
                Require all granted
        </Location>

        RewriteEngine On
        RewriteCond %{SERVER_NAME} =stream.antentafm.ddnss.de
        RewriteRule ^ https://%{SERVER_NAME}%{REQUEST_URI} [END,NE,R=permanent]
</VirtualHost>

<IfModule mod_ssl.c>
<VirtualHost *:443>
	ServerAdmin hust@earth
	ServerName stream.antentafm.ddnss.de

	DocumentRoot /usr/share/icecast2/web
	<Directory /usr/share/icecst2/web>
			Options Indexes FollowSymLinks MultiViews
			AllowOverride None
			Require all granted
	</Directory>

	LogLevel info
	ErrorLog /var/log/stream.antentafm.ddnss.de.error.log
	TransferLog /var/log/stream.antentafm.ddnss.de.access.log

        SSLEngine On
        Include /etc/letsencrypt/options-ssl-apache.conf
        SSLCertificateFile /etc/letsencrypt/live/antentafm.ddnss.de/fullchain.pem
        SSLCertificateKeyFile /etc/letsencrypt/live/antentafm.ddnss.de/privkey.pem

	RewriteEngine On
	RewriteCond %{HTTP:Upgrade} =websocket [NC]
	RewriteRule /(.*)           ws://localhost:8090/$1 [P,L]
	RewriteCond %{HTTP:Upgrade} !=websocket [NC]
	RewriteRule /(.*)           http://localhost:8090/$1 [P,L]

	ProxyPassReverse /          http://localhost:8090/
</VirtualHost>
</IfModule>

